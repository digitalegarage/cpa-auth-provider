# run using: docker-compose -f docker-compose-rts.yaml up
version: '2'
services:
  identity-provider:
    restart: always
    build: .
    ports:
    - 3000:3000
    environment:
    - BASE_URL=https://cpa.rts.ch
    - MAIL_FROM=no-reply@rts.ch
    - IDP_HOST=http://localhost:3000
    - IDP_RECAPCHA_SITEKEY=6Lc6NCYUAAAAAPiyvFO2jig6jXGtYEhgZWtWFzml
    - IDP_RECAPCHA_SECRETKEY=6Lc6NCYUAAAAALCXdWXUsZgDBl7fn9XA_ecVpu7m
    - DEFAULT_LOCALE=fr
    - OPEN_AM_ENABLED=true
    - OPEN_AM_SERVICE_URL=https://sso.rts.ch/
    - MAIL_TRANSPORT_TYPE=test
    - MAIL_USER_NAME=username
    - MAIL_PASSWORD=password
    - TRACKING_COOKIE=true
    - IDP_CLIENT_URL=http://hummingbird-sandbox-marts.rts.ch
    - BROADCASTER_LAYOUT=rts
    - MAIL_DEFAULT_TEMPLATE_CLASS=rts
    - AUTO_IDP_REDIRECT=local
    - DISPLAY_MENU_BAR=
    - IDP_TITLE=Radio Télévision Suisse - Fournisseur d'identité
    - SENTRY_DSN=https://e72ec5652a4b4053a8b5347d5d155e1b:1d87bd47a5ae4820b6be3c6d0e3501cb@error-tracking.ebu.io/13

  nginx:
    image: nginx
    restart: always
    ports:
    - "80:80"
    - "443:443"
    volumes:
    - ./nginx/conf:/etc/nginx/:ro
    - ./nginx/ssl:/etc/ssl/certs:ro
