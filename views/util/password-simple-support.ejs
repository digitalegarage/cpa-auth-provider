<script>


    var BACK_SIGNUP_PASS_SIMPLE_TOO_SIMPLE = '<%= __("BACK_SIGNUP_PASS_SIMPLE_TOO_SIMPLE") %>';
    var BACK_SIGNUP_PASS_SIMPLE_TOO_SHORT = '<%= __("BACK_SIGNUP_PASS_SIMPLE_TOO_SHORT_FRONT", {length: config.password.minimalPasswordLength}) %>';

    var minimalExpectedScore = <%= config.password.minimalExpectedScore %>;
    var goodScore = <%= config.password.goodScore %>;

    $(".password-test").on("keyup", function (event) {
        validatePassword($(this).val());
    });

    function validatePassword(password) {
        var passwordLabel = document.getElementById("password-error-label");
        var score = getScore(password);

        if (password.length > 0 && password !== "") {
            passwordLabel.style.display = "block";
            if (password.length >= MIN_PASSWORD_LENGTH) {
                passwordLabel.innerHTML = BACK_SIGNUP_PASS_SIMPLE_TOO_SIMPLE;
            } else {
                passwordLabel.innerHTML = BACK_SIGNUP_PASS_SIMPLE_TOO_SHORT;
            }
        } else {
            document.getElementById("password-progress").style.width = "0%";
            passwordLabel.style.display = "none";
        }
        setProgress(score);
    }

    function setProgress(score) {
        var progressBar = document.getElementById("password-progress");

        if (score < minimalExpectedScore) {
            progressBar.style.backgroundColor = "red";
        } else if (score < goodScore) {
            progressBar.style.backgroundColor = "lime";
        } else {
            progressBar.style.backgroundColor = "green";
        }

        var progress = Math.min(goodScore, score)

        if (score >= goodScore){
            progressBar.style.width = "100%";
        } else {
            progressBar.style.width = 20 + (progress / goodScore * 60) + "%";
        }
    }
</script>