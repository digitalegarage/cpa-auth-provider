<script>


    var BACK_SIGNUP_PASS_SIMPLE_TOO_SIMPLE = '<%= __("BACK_SIGNUP_PASS_SIMPLE_TOO_SIMPLE") %>';
    var BACK_SIGNUP_PASS_SIMPLE_TOO_SHORT = '<%= __("BACK_SIGNUP_PASS_SIMPLE_TOO_SHORT_FRONT", {length: config.password.minimalPasswordLength}) %>';

    var minimalExpectedScore = '<%= config.password.minimalExpectedScore %>';
    if (minimalExpectedScore === '') {
        minimalExpectedScore = 0.2;
    } else {
        minimalExpectedScore = parseFloat(minimalExpectedScore);
    }
    var goodScore = '<%= config.password.goodScore %>';
    if (goodScore === '') {
        goodScore = 0.3;
    } else {
        goodScore = parseFloat(goodScore);
    }
    var miniPasswordLength = '<%= config.password.minimalPasswordLength %>';
    if (miniPasswordLength === '') {
        miniPasswordLength = 4;
    } else {
        miniPasswordLength = parseInt(miniPasswordLength);
    }

    $(".password-test").on("keyup", function (event) {
        validatePassword($(this).val());
    });

    function validatePassword(password) {
        var passwordLabel = document.getElementById("password-error-label");
        var score = getScore(password);

        if (password.length > 0 && password !== "") {
            passwordLabel.style.display = "block";
            if (password.length >= miniPasswordLength) {
                passwordLabel.innerHTML = BACK_SIGNUP_PASS_SIMPLE_TOO_SIMPLE;
            } else {
                passwordLabel.innerHTML = BACK_SIGNUP_PASS_SIMPLE_TOO_SHORT;
            }
        } else {
            document.getElementById("password-progress").style.width = "0%";
            passwordLabel.style.display = "none";
        }
        setProgress(score);
    }

    function setProgress(score) {
        var progressBar = document.getElementById("password-progress");

        if (score < minimalExpectedScore) {
            progressBar.style.backgroundColor = "red";
        } else {
            document.getElementById("password-error-label").style.display = "none";
            if (score < goodScore) {
                progressBar.style.backgroundColor = "lime";
            } else {
                progressBar.style.backgroundColor = "green";
            }
        }

        var progress = Math.min(goodScore, score)

        if (score >= goodScore) {
            progressBar.style.width = "100%";
        } else {
            progressBar.style.width = 20 + (progress / goodScore * 60) + "%";
        }
    }
</script>